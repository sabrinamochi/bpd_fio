!function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=5)}([function(t,e,r){t.exports=function(){"use strict";function t(t){return"scrollama__debug-offset--"+t}function e(e){!function(e){var r=e.id,n=e.offsetVal,o=e.stepClass,a=document.createElement("div");a.id=t(r),a.className="scrollama__debug-offset",a.style.position="fixed",a.style.left="0",a.style.width="100%",a.style.height="0",a.style.borderTop="2px dashed black",a.style.zIndex="9999";var i=document.createElement("p");i.innerHTML='".'+o+'" trigger: <span>'+n+"</span>",i.style.fontSize="12px",i.style.fontFamily="monospace",i.style.color="black",i.style.margin="0",i.style.padding="6px",a.appendChild(i),document.body.appendChild(a)}({id:e.id,offsetVal:e.offsetVal,stepClass:e.stepEl[0].className})}function r(t){var e=t.id,r=t.index,n=t.state,o="scrollama__debug-step--"+e+"-"+r,a=document.getElementById(o+"_above"),i=document.getElementById(o+"_below"),s="enter"===n?"block":"none";a&&(a.style.display=s),i&&(i.style.display=s)}return function(){var n=["stepAbove","stepBelow","stepProgress","viewportAbove","viewportBelow"],o={},a={},i=null,s=[],l=[],c=[],p=[],d=0,h=0,f=0,u=0,g=0,m=0,v=!1,b=!1,y=!1,w=!1,x=!1,_=!1,M="down",k="percent",A=[];function E(t){console.error("scrollama error: "+t)}function S(){o={stepEnter:function(){},stepExit:function(){},stepProgress:function(){}},a={}}function $(t){return t.getBoundingClientRect().top+window.pageYOffset-(document.body.clientTop||0)}function q(t){return+t.getAttribute("data-scrollama-index")}function T(){window.pageYOffset>g?M="down":window.pageYOffset<g&&(M="up"),g=window.pageYOffset}function P(t){a[t]&&a[t].forEach((function(t){return t.disconnect()}))}function B(){var e,r;f=window.innerHeight,e=document.body,r=document.documentElement,u=Math.max(e.scrollHeight,e.offsetHeight,r.clientHeight,r.scrollHeight,r.offsetHeight),h=d*("pixels"===k?1:f),v&&(l=s.map((function(t){return t.getBoundingClientRect().height})),c=s.map($),b&&D()),y&&function(e){var r=e.id,n=e.offsetMargin,o=e.offsetVal,a="pixels"===e.format?"px":"",i=t(r),s=document.getElementById(i);s.style.top=n+"px",s.querySelector("span").innerText=""+o+a}({id:i,offsetMargin:h,offsetVal:d,format:k})}function L(t){if(t&&!b){if(!v)return E("scrollama error: enable() called before scroller was ready"),void(b=!1);D()}!t&&b&&n.forEach(P),b=t}function O(t,e){var r=q(t);void 0!==e&&(p[r].progress=e);var n={element:t,index:r,progress:p[r].progress};"enter"===p[r].state&&o.stepProgress(n)}function I(t,e){if("above"===e)for(var r=0;r<t;r+=1){var n=p[r];"enter"!==n.state&&"down"!==n.direction?(j(s[r],"down",!1),N(s[r],"down")):"enter"===n.state&&N(s[r],"down")}else if("below"===e)for(var o=p.length-1;o>t;o-=1){var a=p[o];"enter"===a.state&&N(s[o],"up"),"down"===a.direction&&(j(s[o],"up",!1),N(s[o],"up"))}}function j(t,e,n){void 0===n&&(n=!0);var a=q(t),s={element:t,index:a,direction:e};p[a].direction=e,p[a].state="enter",x&&n&&"down"===e&&I(a,"above"),x&&n&&"up"===e&&I(a,"below"),o.stepEnter&&!A[a]&&(o.stepEnter(s,p),y&&r({id:i,index:a,state:"enter"}),_&&(A[a]=!0)),w&&O(t)}function N(t,e){var n=q(t),a={element:t,index:n,direction:e};w&&("down"===e&&p[n].progress<1?O(t,1):"up"===e&&p[n].progress>0&&O(t,0)),p[n].direction=e,p[n].state="exit",o.stepExit(a,p),y&&r({id:i,index:n,state:"exit"})}function z(t){var e=t[0];T();var r=e.isIntersecting,n=e.boundingClientRect,o=e.target,a=n.top,i=n.bottom,s=a-h,l=i-h,c=q(o),d=p[c];r&&s<=0&&l>=0&&"down"===M&&"enter"!==d.state&&j(o,M),!r&&s>0&&"up"===M&&"enter"===d.state&&N(o,M)}function C(t){var e=t[0];T();var r=e.isIntersecting,n=e.boundingClientRect,o=e.target,a=n.top,i=n.bottom,s=a-h,l=i-h,c=q(o),d=p[c];r&&s<=0&&l>=0&&"up"===M&&"enter"!==d.state&&j(o,M),!r&&l<0&&"down"===M&&"enter"===d.state&&N(o,M)}function H(t){var e=t[0];T();var r=e.isIntersecting,n=e.target,o=q(n),a=p[o];r&&"down"===M&&"down"!==a.direction&&"enter"!==a.state&&(j(n,"down"),N(n,"down"))}function R(t){var e=t[0];T();var r=e.isIntersecting,n=e.target,o=q(n),a=p[o];r&&"up"===M&&"down"===a.direction&&"enter"!==a.state&&(j(n,"up"),N(n,"up"))}function W(t){var e=t[0];T();var r=e.isIntersecting,n=e.intersectionRatio,o=e.boundingClientRect,a=e.target,i=o.bottom;r&&i-h>=0&&O(a,+n)}function F(){a.stepProgress=s.map((function(t,e){var r=l[e]-h+"px 0px "+(-f+h)+"px 0px",n=function(t){for(var e=Math.ceil(t/m),r=[],n=1/e,o=0;o<e;o+=1)r.push(o*n);return r}(l[e]),o=new IntersectionObserver(W,{rootMargin:r,threshold:n});return o.observe(t),o}))}function D(){n.forEach(P),a.viewportAbove=s.map((function(t,e){var r=u-c[e],n=h-f-l[e],o=new IntersectionObserver(H,{rootMargin:r+"px 0px "+n+"px 0px"});return o.observe(t),o})),a.viewportBelow=s.map((function(t,e){var r=-h-l[e],n=h-f+l[e]+u,o=new IntersectionObserver(R,{rootMargin:r+"px 0px "+n+"px 0px"});return o.observe(t),o})),a.stepAbove=s.map((function(t,e){var r=-h+l[e],n=new IntersectionObserver(z,{rootMargin:r+"px 0px "+(h-f)+"px 0px"});return n.observe(t),n})),a.stepBelow=s.map((function(t,e){var r=-h,n=h-f+l[e],o=new IntersectionObserver(C,{rootMargin:r+"px 0px "+n+"px 0px"});return o.observe(t),o})),w&&F()}function V(t){return!(!t||1!==t.nodeType)&&(function(t){var e=window.getComputedStyle(t);return("scroll"===e.overflowY||"auto"===e.overflowY)&&t.scrollHeight>t.clientHeight}(t)?t:V(t.parentNode))}var Y={setup:function(t){var r=t.step,n=t.offset;void 0===n&&(n=.5);var o=t.progress;void 0===o&&(o=!1);var a=t.threshold;void 0===a&&(a=4);var l=t.debug;void 0===l&&(l=!1);var c=t.order;void 0===c&&(c=!0);var h,f,u,g,b,M=t.once;if(void 0===M&&(M=!1),S(),f=(h="abcdefghijklmnopqrstuv").length,u=Date.now(),i=""+[0,0,0].map((function(t){return h[Math.floor(Math.random()*f)]})).join("")+u,g=r,void 0===b&&(b=document),!(s="string"==typeof g?Array.from(b.querySelectorAll(g)):g instanceof Element?[g]:g instanceof NodeList?Array.from(g):g instanceof Array?g:[]).length)return E("no step elements"),Y;var k=s.reduce((function(t,e){return t||V(e.parentNode)}),!1);return k&&console.error("scrollama error: step elements cannot be children of a scrollable element. Remove any css on the parent element with overflow: scroll; or overflow: auto; on elements with fixed height.",k),y=l,w=o,x=c,_=M,Y.offsetTrigger(n),m=Math.max(1,+a),v=!0,y&&e({id:i,stepEl:s,offsetVal:d}),s.forEach((function(t,e){return t.setAttribute("data-scrollama-index",e)})),p=s.map((function(){return{direction:null,state:null,progress:0}})),B(),Y.enable(),Y},resize:function(){return B(),Y},enable:function(){return L(!0),Y},disable:function(){return L(!1),Y},destroy:function(){L(!1),S()},offsetTrigger:function(t){if(null===t)return d;if("number"==typeof t)k="percent",t>1&&E("offset value is greater than 1. Fallback to 1."),t<0&&E("offset value is lower than 0. Fallback to 0."),d=Math.min(Math.max(0,t),1);else if("string"==typeof t&&t.indexOf("px")>0){var e=+t.replace("px","");isNaN(e)?(E("offset value must be in 'px' format. Fallback to 0.5."),d=.5):(k="pixels",d=e)}else E("offset value does not include 'px'. Fallback to 0.5."),d=.5;return Y},onStepEnter:function(t){return"function"==typeof t?o.stepEnter=t:E("onStepEnter requires a function"),Y},onStepExit:function(t){return"function"==typeof t?o.stepExit=t:E("onStepExit requires a function"),Y},onStepProgress:function(t){return"function"==typeof t?o.stepProgress=t:E("onStepProgress requires a function"),Y}};return Y}}()},function(t,e,r){!function(e,r){"use strict";var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var o,a=!1,i=void 0!==e;i&&e.getComputedStyle?(o=r.createElement("div"),["","-webkit-","-moz-","-ms-"].some((function(t){try{o.style.position=t+"sticky"}catch(t){}return""!=o.style.position}))&&(a=!0)):a=!0;var s=!1,l="undefined"!=typeof ShadowRoot,c={top:null,left:null},p=[];function d(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])}function h(t){return parseFloat(t)||0}function f(t){for(var e=0;t;)e+=t.offsetTop,t=t.offsetParent;return e}var u=function(){function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!(e instanceof HTMLElement))throw new Error("First argument must be HTMLElement");if(p.some((function(t){return t._node===e})))throw new Error("Stickyfill is already applied to this node");this._node=e,this._stickyMode=null,this._active=!1,p.push(this),this.refresh()}return n(t,[{key:"refresh",value:function(){if(!a&&!this._removed){this._active&&this._deactivate();var t=this._node,n=getComputedStyle(t),o={position:n.position,top:n.top,display:n.display,marginTop:n.marginTop,marginBottom:n.marginBottom,marginLeft:n.marginLeft,marginRight:n.marginRight,cssFloat:n.cssFloat};if(!isNaN(parseFloat(o.top))&&"table-cell"!=o.display&&"none"!=o.display){this._active=!0;var i=t.style.position;"sticky"!=n.position&&"-webkit-sticky"!=n.position||(t.style.position="static");var s=t.parentNode,c=l&&s instanceof ShadowRoot?s.host:s,p=t.getBoundingClientRect(),u=c.getBoundingClientRect(),g=getComputedStyle(c);this._parent={node:c,styles:{position:c.style.position},offsetHeight:c.offsetHeight},this._offsetToWindow={left:p.left,right:r.documentElement.clientWidth-p.right},this._offsetToParent={top:p.top-u.top-h(g.borderTopWidth),left:p.left-u.left-h(g.borderLeftWidth),right:-p.right+u.right-h(g.borderRightWidth)},this._styles={position:i,top:t.style.top,bottom:t.style.bottom,left:t.style.left,right:t.style.right,width:t.style.width,marginTop:t.style.marginTop,marginLeft:t.style.marginLeft,marginRight:t.style.marginRight};var m=h(o.top);this._limits={start:p.top+e.pageYOffset-m,end:u.top+e.pageYOffset+c.offsetHeight-h(g.borderBottomWidth)-t.offsetHeight-m-h(o.marginBottom)};var v=g.position;"absolute"!=v&&"relative"!=v&&(c.style.position="relative"),this._recalcPosition();var b=this._clone={};b.node=r.createElement("div"),d(b.node.style,{width:p.right-p.left+"px",height:p.bottom-p.top+"px",marginTop:o.marginTop,marginBottom:o.marginBottom,marginLeft:o.marginLeft,marginRight:o.marginRight,cssFloat:o.cssFloat,padding:0,border:0,borderSpacing:0,fontSize:"1em",position:"static"}),s.insertBefore(b.node,t),b.docOffsetTop=f(b.node)}}}},{key:"_recalcPosition",value:function(){if(this._active&&!this._removed){var t=c.top<=this._limits.start?"start":c.top>=this._limits.end?"end":"middle";if(this._stickyMode!=t){switch(t){case"start":d(this._node.style,{position:"absolute",left:this._offsetToParent.left+"px",right:this._offsetToParent.right+"px",top:this._offsetToParent.top+"px",bottom:"auto",width:"auto",marginLeft:0,marginRight:0,marginTop:0});break;case"middle":d(this._node.style,{position:"fixed",left:this._offsetToWindow.left+"px",right:this._offsetToWindow.right+"px",top:this._styles.top,bottom:"auto",width:"auto",marginLeft:0,marginRight:0,marginTop:0});break;case"end":d(this._node.style,{position:"absolute",left:this._offsetToParent.left+"px",right:this._offsetToParent.right+"px",top:"auto",bottom:0,width:"auto",marginLeft:0,marginRight:0})}this._stickyMode=t}}}},{key:"_fastCheck",value:function(){this._active&&!this._removed&&(Math.abs(f(this._clone.node)-this._clone.docOffsetTop)>1||Math.abs(this._parent.node.offsetHeight-this._parent.offsetHeight)>1)&&this.refresh()}},{key:"_deactivate",value:function(){var t=this;this._active&&!this._removed&&(this._clone.node.parentNode.removeChild(this._clone.node),delete this._clone,d(this._node.style,this._styles),delete this._styles,p.some((function(e){return e!==t&&e._parent&&e._parent.node===t._parent.node}))||d(this._parent.node.style,this._parent.styles),delete this._parent,this._stickyMode=null,this._active=!1,delete this._offsetToWindow,delete this._offsetToParent,delete this._limits)}},{key:"remove",value:function(){var t=this;this._deactivate(),p.some((function(e,r){if(e._node===t._node)return p.splice(r,1),!0})),this._removed=!0}}]),t}(),g={stickies:p,Sticky:u,forceSticky:function(){a=!1,m(),this.refreshAll()},addOne:function(t){if(!(t instanceof HTMLElement)){if(!t.length||!t[0])return;t=t[0]}for(var e=0;e<p.length;e++)if(p[e]._node===t)return p[e];return new u(t)},add:function(t){if(t instanceof HTMLElement&&(t=[t]),t.length){for(var e=[],r=function(r){var n=t[r];return n instanceof HTMLElement?p.some((function(t){if(t._node===n)return e.push(t),!0}))?"continue":void e.push(new u(n)):(e.push(void 0),"continue")},n=0;n<t.length;n++)r(n);return e}},refreshAll:function(){p.forEach((function(t){return t.refresh()}))},removeOne:function(t){if(!(t instanceof HTMLElement)){if(!t.length||!t[0])return;t=t[0]}p.some((function(e){if(e._node===t)return e.remove(),!0}))},remove:function(t){if(t instanceof HTMLElement&&(t=[t]),t.length)for(var e=function(e){var r=t[e];p.some((function(t){if(t._node===r)return t.remove(),!0}))},r=0;r<t.length;r++)e(r)},removeAll:function(){for(;p.length;)p[0].remove()}};function m(){if(!s){s=!0,a(),e.addEventListener("scroll",a),e.addEventListener("resize",g.refreshAll),e.addEventListener("orientationchange",g.refreshAll);var t=void 0,n=void 0,o=void 0;"hidden"in r?(n="hidden",o="visibilitychange"):"webkitHidden"in r&&(n="webkitHidden",o="webkitvisibilitychange"),o?(r[n]||i(),r.addEventListener(o,(function(){r[n]?clearInterval(t):i()}))):i()}function a(){e.pageXOffset!=c.left?(c.top=e.pageYOffset,c.left=e.pageXOffset,g.refreshAll()):e.pageYOffset!=c.top&&(c.top=e.pageYOffset,c.left=e.pageXOffset,p.forEach((function(t){return t._recalcPosition()})))}function i(){t=setInterval((function(){p.forEach((function(t){return t._fastCheck()}))}),500)}}a||m(),t.exports?t.exports=g:i&&(e.Stickyfill=g)}(window,document)},function(t,e,r){(function(e){var r=/^\s+|\s+$/g,n=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,a=/^0o[0-7]+$/i,i=parseInt,s="object"==typeof e&&e&&e.Object===Object&&e,l="object"==typeof self&&self&&self.Object===Object&&self,c=s||l||Function("return this")(),p=Object.prototype.toString,d=Math.max,h=Math.min,f=function(){return c.Date.now()};function u(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function g(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==p.call(t)}(t))return NaN;if(u(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=u(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(r,"");var s=o.test(t);return s||a.test(t)?i(t.slice(2),s?2:8):n.test(t)?NaN:+t}t.exports=function(t,e,r){var n,o,a,i,s,l,c=0,p=!1,m=!1,v=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function b(e){var r=n,a=o;return n=o=void 0,c=e,i=t.apply(a,r)}function y(t){return c=t,s=setTimeout(x,e),p?b(t):i}function w(t){var r=t-l;return void 0===l||r>=e||r<0||m&&t-c>=a}function x(){var t=f();if(w(t))return _(t);s=setTimeout(x,function(t){var r=e-(t-l);return m?h(r,a-(t-c)):r}(t))}function _(t){return s=void 0,v&&n?b(t):(n=o=void 0,i)}function M(){var t=f(),r=w(t);if(n=arguments,o=this,l=t,r){if(void 0===s)return y(l);if(m)return s=setTimeout(x,e),b(l)}return void 0===s&&(s=setTimeout(x,e)),i}return e=g(e)||0,u(r)&&(p=!!r.leading,a=(m="maxWait"in r)?d(g(r.maxWait)||0,e):a,v="trailing"in r?!!r.trailing:v),M.cancel=function(){void 0!==s&&clearTimeout(s),c=0,n=l=o=s=void 0},M.flush=function(){return void 0===s?i:_(f())},M}}).call(this,r(3))},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){!function(t){"use strict";function e(t){if(0===t.length)return 0;for(var e,r=t[0],n=0,o=1;o<t.length;o++)e=r+t[o],Math.abs(r)>=Math.abs(t[o])?n+=r-e+t[o]:n+=t[o]-e+r,r=e;return r+n}function r(t){if(0===t.length)throw new Error("mean requires at least one data point");return e(t)/t.length}function n(t,e){var n,o,a=r(t),i=0;if(2===e)for(o=0;o<t.length;o++)i+=(n=t[o]-a)*n;else for(o=0;o<t.length;o++)i+=Math.pow(t[o]-a,e);return i}function o(t){if(0===t.length)throw new Error("variance requires at least one data point");return n(t,2)/t.length}function a(t){if(1===t.length)return 0;var e=o(t);return Math.sqrt(e)}function i(t){if(0===t.length)throw new Error("mode requires at least one data point");if(1===t.length)return t[0];for(var e=t[0],r=NaN,n=0,o=1,a=1;a<t.length+1;a++)t[a]!==e?(o>n&&(n=o,r=e),o=1,e=t[a]):o++;return r}function s(t){return t.slice().sort((function(t,e){return t-e}))}function l(t){if(0===t.length)throw new Error("min requires at least one data point");for(var e=t[0],r=1;r<t.length;r++)t[r]<e&&(e=t[r]);return e}function c(t){if(0===t.length)throw new Error("max requires at least one data point");for(var e=t[0],r=1;r<t.length;r++)t[r]>e&&(e=t[r]);return e}function p(t){for(var e=0,r=0;r<t.length;r++)e+=t[r];return e}function d(t,e){var r=t.length*e;if(0===t.length)throw new Error("quantile requires at least one data point.");if(e<0||e>1)throw new Error("quantiles must be between 0 and 1");return 1===e?t[t.length-1]:0===e?t[0]:r%1!=0?t[Math.ceil(r)-1]:t.length%2==0?(t[r-1]+t[r])/2:t[r]}function h(t,e,r,n){for(r=r||0,n=n||t.length-1;n>r;){if(n-r>600){var o=n-r+1,a=e-r+1,i=Math.log(o),s=.5*Math.exp(2*i/3),l=.5*Math.sqrt(i*s*(o-s)/o);a-o/2<0&&(l*=-1),h(t,e,Math.max(r,Math.floor(e-a*s/o+l)),Math.min(n,Math.floor(e+(o-a)*s/o+l)))}var c=t[e],p=r,d=n;for(f(t,r,e),t[n]>c&&f(t,r,n);p<d;){for(f(t,p,d),p++,d--;t[p]<c;)p++;for(;t[d]>c;)d--}t[r]===c?f(t,r,d):f(t,++d,n),d<=e&&(r=d+1),e<=d&&(n=d-1)}}function f(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function u(t,e){var r=t.slice();if(Array.isArray(e)){!function(t,e){for(var r=[0],n=0;n<e.length;n++)r.push(v(t.length,e[n]));r.push(t.length-1),r.sort(m);for(var o=[0,r.length-1];o.length;){var a=Math.ceil(o.pop()),i=Math.floor(o.pop());if(!(a-i<=1)){var s=Math.floor((i+a)/2);g(t,r[s],Math.floor(r[i]),Math.ceil(r[a])),o.push(i,s,s,a)}}}(r,e);for(var n=[],o=0;o<e.length;o++)n[o]=d(r,e[o]);return n}return g(r,v(r.length,e),0,r.length-1),d(r,e)}function g(t,e,r,n){e%1==0?h(t,e,r,n):(h(t,e=Math.floor(e),r,n),h(t,e+1,e+1,n))}function m(t,e){return t-e}function v(t,e){var r=t*e;return 1===e?t-1:0===e?0:r%1!=0?Math.ceil(r)-1:t%2==0?r-.5:r}function b(t,e){if(e<t[0])return 0;if(e>t[t.length-1])return 1;var r=function(t,e){for(var r=0,n=0,o=t.length;n<o;)e<=t[r=n+o>>>1]?o=r:n=-~r;return n}(t,e);if(t[r]!==e)return r/t.length;r++;var n=function(t,e){for(var r=0,n=0,o=t.length;n<o;)e>=t[r=n+o>>>1]?n=-~r:o=r;return n}(t,e);if(n===r)return r/t.length;var o=n-r+1;return o*(n+r)/2/o/t.length}function y(t){var e=u(t,.75),r=u(t,.25);if("number"==typeof e&&"number"==typeof r)return e-r}function w(t){return+u(t,.5)}function x(t){for(var e=w(t),r=[],n=0;n<t.length;n++)r.push(Math.abs(t[n]-e));return w(r)}function _(t,e){e=e||Math.random;for(var r,n,o=t.length;o>0;)n=Math.floor(e()*o--),r=t[o],t[o]=t[n],t[n]=r;return t}function M(t,e){return _(t.slice(),e)}function k(t,e,r){return M(t,r).slice(0,e)}function A(t,e){for(var r=[],n=0;n<t;n++){for(var o=[],a=0;a<e;a++)o.push(0);r.push(o)}return r}function E(t){for(var e,r=0,n=0;n<t.length;n++)0!==n&&t[n]===e||(e=t[n],r++);return r}function S(t,e,r,n){var o;if(t>0){var a=(r[e]-r[t-1])/(e-t+1);o=n[e]-n[t-1]-(e-t+1)*a*a}else o=n[e]-r[e]*r[e]/(e+1);return o<0?0:o}function $(t,e,r,n,o,a,i){if(!(t>e)){var s=Math.floor((t+e)/2);n[r][s]=n[r-1][s-1],o[r][s]=s;var l=r;t>r&&(l=Math.max(l,o[r][t-1]||0)),l=Math.max(l,o[r-1][s]||0);var c,p,d,h=s-1;e<n[0].length-1&&(h=Math.min(h,o[r][e+1]||0));for(var f=h;f>=l&&!((c=S(f,s,a,i))+n[r-1][l-1]>=n[r][s]);--f)(p=S(l,s,a,i)+n[r-1][l-1])<n[r][s]&&(n[r][s]=p,o[r][s]=l),l++,(d=c+n[r-1][f-1])<n[r][s]&&(n[r][s]=d,o[r][s]=f);$(t,s-1,r,n,o,a,i),$(s+1,e,r,n,o,a,i)}}function q(t,e){if(t.length!==e.length)throw new Error("sampleCovariance requires samples with equal lengths");if(t.length<2)throw new Error("sampleCovariance requires at least two data points in each sample");for(var n=r(t),o=r(e),a=0,i=0;i<t.length;i++)a+=(t[i]-n)*(e[i]-o);return a/(t.length-1)}function T(t){if(t.length<2)throw new Error("sampleVariance requires at least two data points");return n(t,2)/(t.length-1)}function P(t){var e=T(t);return Math.sqrt(e)}function B(t,e,r,n){return(t*e+r*n)/(e+n)}function L(t){if(0===t.length)throw new Error("meanSimple requires at least one data point");return p(t)/t.length}function O(t){if(0===t.length)throw new Error("rootMeanSquare requires at least one data point");for(var e=0,r=0;r<t.length;r++)e+=Math.pow(t[r],2);return Math.sqrt(e/t.length)}var I=function(){this.totalCount=0,this.data={}};I.prototype.train=function(t,e){for(var r in this.data[e]||(this.data[e]={}),t){var n=t[r];void 0===this.data[e][r]&&(this.data[e][r]={}),void 0===this.data[e][r][n]&&(this.data[e][r][n]=0),this.data[e][r][n]++}this.totalCount++},I.prototype.score=function(t){var e,r={};for(var n in t){var o=t[n];for(e in this.data)r[e]={},this.data[e][n]?r[e][n+"_"+o]=(this.data[e][n][o]||0)/this.totalCount:r[e][n+"_"+o]=0}var a={};for(e in r)for(var i in a[e]=0,r[e])a[e]+=r[e][i];return a};var j=function(){this.weights=[],this.bias=0};j.prototype.predict=function(t){if(t.length!==this.weights.length)return null;for(var e=0,r=0;r<this.weights.length;r++)e+=this.weights[r]*t[r];return(e+=this.bias)>0?1:0},j.prototype.train=function(t,e){if(0!==e&&1!==e)return null;t.length!==this.weights.length&&(this.weights=t,this.bias=1);var r=this.predict(t);if("number"==typeof r&&r!==e){for(var n=e-r,o=0;o<this.weights.length;o++)this.weights[o]+=n*t[o];this.bias+=n}return this};var N=1e-4;function z(t){if(t<0)throw new Error("factorial requires a non-negative value");if(Math.floor(t)!==t)throw new Error("factorial requires an integer input");for(var e=1,r=2;r<=t;r++)e*=r;return e}var C=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],H=Math.log(Math.sqrt(2*Math.PI)),R={1:{.995:0,.99:0,.975:0,.95:0,.9:.02,.5:.45,.1:2.71,.05:3.84,.025:5.02,.01:6.63,.005:7.88},2:{.995:.01,.99:.02,.975:.05,.95:.1,.9:.21,.5:1.39,.1:4.61,.05:5.99,.025:7.38,.01:9.21,.005:10.6},3:{.995:.07,.99:.11,.975:.22,.95:.35,.9:.58,.5:2.37,.1:6.25,.05:7.81,.025:9.35,.01:11.34,.005:12.84},4:{.995:.21,.99:.3,.975:.48,.95:.71,.9:1.06,.5:3.36,.1:7.78,.05:9.49,.025:11.14,.01:13.28,.005:14.86},5:{.995:.41,.99:.55,.975:.83,.95:1.15,.9:1.61,.5:4.35,.1:9.24,.05:11.07,.025:12.83,.01:15.09,.005:16.75},6:{.995:.68,.99:.87,.975:1.24,.95:1.64,.9:2.2,.5:5.35,.1:10.65,.05:12.59,.025:14.45,.01:16.81,.005:18.55},7:{.995:.99,.99:1.25,.975:1.69,.95:2.17,.9:2.83,.5:6.35,.1:12.02,.05:14.07,.025:16.01,.01:18.48,.005:20.28},8:{.995:1.34,.99:1.65,.975:2.18,.95:2.73,.9:3.49,.5:7.34,.1:13.36,.05:15.51,.025:17.53,.01:20.09,.005:21.96},9:{.995:1.73,.99:2.09,.975:2.7,.95:3.33,.9:4.17,.5:8.34,.1:14.68,.05:16.92,.025:19.02,.01:21.67,.005:23.59},10:{.995:2.16,.99:2.56,.975:3.25,.95:3.94,.9:4.87,.5:9.34,.1:15.99,.05:18.31,.025:20.48,.01:23.21,.005:25.19},11:{.995:2.6,.99:3.05,.975:3.82,.95:4.57,.9:5.58,.5:10.34,.1:17.28,.05:19.68,.025:21.92,.01:24.72,.005:26.76},12:{.995:3.07,.99:3.57,.975:4.4,.95:5.23,.9:6.3,.5:11.34,.1:18.55,.05:21.03,.025:23.34,.01:26.22,.005:28.3},13:{.995:3.57,.99:4.11,.975:5.01,.95:5.89,.9:7.04,.5:12.34,.1:19.81,.05:22.36,.025:24.74,.01:27.69,.005:29.82},14:{.995:4.07,.99:4.66,.975:5.63,.95:6.57,.9:7.79,.5:13.34,.1:21.06,.05:23.68,.025:26.12,.01:29.14,.005:31.32},15:{.995:4.6,.99:5.23,.975:6.27,.95:7.26,.9:8.55,.5:14.34,.1:22.31,.05:25,.025:27.49,.01:30.58,.005:32.8},16:{.995:5.14,.99:5.81,.975:6.91,.95:7.96,.9:9.31,.5:15.34,.1:23.54,.05:26.3,.025:28.85,.01:32,.005:34.27},17:{.995:5.7,.99:6.41,.975:7.56,.95:8.67,.9:10.09,.5:16.34,.1:24.77,.05:27.59,.025:30.19,.01:33.41,.005:35.72},18:{.995:6.26,.99:7.01,.975:8.23,.95:9.39,.9:10.87,.5:17.34,.1:25.99,.05:28.87,.025:31.53,.01:34.81,.005:37.16},19:{.995:6.84,.99:7.63,.975:8.91,.95:10.12,.9:11.65,.5:18.34,.1:27.2,.05:30.14,.025:32.85,.01:36.19,.005:38.58},20:{.995:7.43,.99:8.26,.975:9.59,.95:10.85,.9:12.44,.5:19.34,.1:28.41,.05:31.41,.025:34.17,.01:37.57,.005:40},21:{.995:8.03,.99:8.9,.975:10.28,.95:11.59,.9:13.24,.5:20.34,.1:29.62,.05:32.67,.025:35.48,.01:38.93,.005:41.4},22:{.995:8.64,.99:9.54,.975:10.98,.95:12.34,.9:14.04,.5:21.34,.1:30.81,.05:33.92,.025:36.78,.01:40.29,.005:42.8},23:{.995:9.26,.99:10.2,.975:11.69,.95:13.09,.9:14.85,.5:22.34,.1:32.01,.05:35.17,.025:38.08,.01:41.64,.005:44.18},24:{.995:9.89,.99:10.86,.975:12.4,.95:13.85,.9:15.66,.5:23.34,.1:33.2,.05:36.42,.025:39.36,.01:42.98,.005:45.56},25:{.995:10.52,.99:11.52,.975:13.12,.95:14.61,.9:16.47,.5:24.34,.1:34.28,.05:37.65,.025:40.65,.01:44.31,.005:46.93},26:{.995:11.16,.99:12.2,.975:13.84,.95:15.38,.9:17.29,.5:25.34,.1:35.56,.05:38.89,.025:41.92,.01:45.64,.005:48.29},27:{.995:11.81,.99:12.88,.975:14.57,.95:16.15,.9:18.11,.5:26.34,.1:36.74,.05:40.11,.025:43.19,.01:46.96,.005:49.65},28:{.995:12.46,.99:13.57,.975:15.31,.95:16.93,.9:18.94,.5:27.34,.1:37.92,.05:41.34,.025:44.46,.01:48.28,.005:50.99},29:{.995:13.12,.99:14.26,.975:16.05,.95:17.71,.9:19.77,.5:28.34,.1:39.09,.05:42.56,.025:45.72,.01:49.59,.005:52.34},30:{.995:13.79,.99:14.95,.975:16.79,.95:18.49,.9:20.6,.5:29.34,.1:40.26,.05:43.77,.025:46.98,.01:50.89,.005:53.67},40:{.995:20.71,.99:22.16,.975:24.43,.95:26.51,.9:29.05,.5:39.34,.1:51.81,.05:55.76,.025:59.34,.01:63.69,.005:66.77},50:{.995:27.99,.99:29.71,.975:32.36,.95:34.76,.9:37.69,.5:49.33,.1:63.17,.05:67.5,.025:71.42,.01:76.15,.005:79.49},60:{.995:35.53,.99:37.48,.975:40.48,.95:43.19,.9:46.46,.5:59.33,.1:74.4,.05:79.08,.025:83.3,.01:88.38,.005:91.95},70:{.995:43.28,.99:45.44,.975:48.76,.95:51.74,.9:55.33,.5:69.33,.1:85.53,.05:90.53,.025:95.02,.01:100.42,.005:104.22},80:{.995:51.17,.99:53.54,.975:57.15,.95:60.39,.9:64.28,.5:79.33,.1:96.58,.05:101.88,.025:106.63,.01:112.33,.005:116.32},90:{.995:59.2,.99:61.75,.975:65.65,.95:69.13,.9:73.29,.5:89.33,.1:107.57,.05:113.14,.025:118.14,.01:124.12,.005:128.3},100:{.995:67.33,.99:70.06,.975:74.22,.95:77.93,.9:82.36,.5:99.33,.1:118.5,.05:124.34,.025:129.56,.01:135.81,.005:140.17}},W=Math.sqrt(2*Math.PI),F={gaussian:function(t){return Math.exp(-.5*t*t)/W}},D={nrd:function(t){var e=P(t),r=y(t);return"number"==typeof r&&(e=Math.min(e,r/1.34)),1.06*e*Math.pow(t.length,-.2)}};function V(t,e,r){var n,o;if(void 0===e)n=F.gaussian;else if("string"==typeof e){if(!F[e])throw new Error('Unknown kernel "'+e+'"');n=F[e]}else n=e;if(void 0===r)o=D.nrd(t);else if("string"==typeof r){if(!D[r])throw new Error('Unknown bandwidth method "'+r+'"');o=D[r](t)}else o=r;return function(e){var r=0,a=0;for(r=0;r<t.length;r++)a+=n((e-t[r])/o);return a/o/t.length}}var Y=Math.sqrt(2*Math.PI);function X(t){for(var e=t,r=t,n=1;n<15;n++)e+=r*=t*t/(2*n+1);return Math.round(1e4*(.5+e/Y*Math.exp(-t*t/2)))/1e4}for(var G=[],U=0;U<=3.09;U+=.01)G.push(X(U));function Z(t){var e=1/(1+.5*Math.abs(t)),r=e*Math.exp(-t*t+((((((((.17087277*e-.82215223)*e+1.48851587)*e-1.13520398)*e+.27886807)*e-.18628806)*e+.09678418)*e+.37409196)*e+1.00002368)*e-1.26551223);return t>=0?1-r:r-1}function K(t){var e=8*(Math.PI-3)/(3*Math.PI*(4-Math.PI)),r=Math.sqrt(Math.sqrt(Math.pow(2/(Math.PI*e)+Math.log(1-t*t)/2,2)-Math.log(1-t*t)/e)-(2/(Math.PI*e)+Math.log(1-t*t)/2));return t>=0?r:-r}function J(t){if("number"==typeof t)return t<0?-1:0===t?0:1;throw new TypeError("not a number")}function Q(t,e){for(var r=0,n=0;n<t.length;n++){var o=t[n]-e[n];r+=o*o}return Math.sqrt(r)}function tt(t,e){return t.map((function(t){for(var r=Number.MAX_VALUE,n=-1,o=0;o<e.length;o++){var a=Q(t,e[o]);a<r&&(r=a,n=o)}return n}))}function et(t,e,r){for(var n=t[0].length,o=A(r,n),a=Array(r).fill(0),i=t.length,s=0;s<i;s++){for(var l=t[s],c=e[s],p=o[c],d=0;d<n;d++)p[d]+=l[d];a[c]+=1}for(var h=0;h<r;h++){if(0===a[h])throw new Error("Centroid "+h+" has no friends");for(var f=o[h],u=0;u<n;u++)f[u]/=a[h]}return o}function rt(t,e){for(var r=0,n=0;n<t.length;n++)r+=Q(t[n],e[n]);return r}function nt(t,e){if(t.length!==e.length)throw new Error("must have exactly as many labels as points");for(var r=function(t){for(var e=1+c(t),r=Array(e),n=0;n<t.length;n++){var o=t[n];void 0===r[o]&&(r[o]=[]),r[o].push(n)}return r}(e),n=function(t){for(var e=t.length,r=A(e,e),n=0;n<e;n++)for(var o=0;o<n;o++)r[n][o]=Q(t[n],t[o]),r[o][n]=r[n][o];return r}(t),o=[],a=0;a<t.length;a++){var i=0;if(r[e[a]].length>1){var s=at(a,r[e[a]],n),l=ot(a,e,r,n);i=(l-s)/Math.max(s,l)}o.push(i)}return o}function ot(t,e,r,n){for(var o=e[t],a=Number.MAX_VALUE,i=0;i<r.length;i++)if(i!==o){var s=at(t,r[i],n);s<a&&(a=s)}return a}function at(t,e,r){for(var n=0,o=0;o<e.length;o++)n+=r[t][e[o]];return n/e.length}function it(t,e){return 0===t&&0===e?0:Math.abs((t-e)/e)}t.BayesianClassifier=I,t.PerceptronModel=j,t.addToMean=function(t,e,r){return t+(r-t)/(e+1)},t.approxEqual=function(t,e,r){return void 0===r&&(r=N),it(t,e)<=r},t.average=r,t.averageSimple=L,t.bayesian=I,t.bernoulliDistribution=function(t){if(t<0||t>1)throw new Error("bernoulliDistribution requires probability to be between 0 and 1 inclusive");return[1-t,t]},t.binomialDistribution=function(t,e){if(!(e<0||e>1||t<=0||t%1!=0)){var r=0,n=0,o=[],a=1;do{o[r]=a*Math.pow(e,r)*Math.pow(1-e,t-r),n+=o[r],a=a*(t-++r+1)/r}while(n<.9999);return o}},t.bisect=function(t,e,r,n,o){if("function"!=typeof t)throw new TypeError("func must be a function");for(var a=0;a<n;a++){var i=(e+r)/2;if(0===t(i)||Math.abs((r-e)/2)<o)return i;J(t(i))===J(t(e))?e=i:r=i}throw new Error("maximum number of iterations exceeded")},t.chiSquaredDistributionTable=R,t.chiSquaredGoodnessOfFit=function(t,e,n){for(var o=0,a=e(r(t)),i=[],s=[],l=0;l<t.length;l++)void 0===i[t[l]]&&(i[t[l]]=0),i[t[l]]++;for(var c=0;c<i.length;c++)void 0===i[c]&&(i[c]=0);for(var p in a)p in i&&(s[+p]=a[p]*t.length);for(var d=s.length-1;d>=0;d--)s[d]<3&&(s[d-1]+=s[d],s.pop(),i[d-1]+=i[d],i.pop());for(var h=0;h<i.length;h++)o+=Math.pow(i[h]-s[h],2)/s[h];var f=i.length-1-1;return R[f][n]<o},t.chunk=function(t,e){var r=[];if(e<1)throw new Error("chunk size must be a positive number");if(Math.floor(e)!==e)throw new Error("chunk size must be an integer");for(var n=0;n<t.length;n+=e)r.push(t.slice(n,n+e));return r},t.ckmeans=function(t,e){if(e>t.length)throw new Error("cannot generate more classes than there are data values");var r=s(t);if(1===E(r))return[r];var n=A(e,r.length),o=A(e,r.length);!function(t,e,r){for(var n=e[0].length,o=t[Math.floor(n/2)],a=[],i=[],s=0,l=void 0;s<n;++s)l=t[s]-o,0===s?(a.push(l),i.push(l*l)):(a.push(a[s-1]+l),i.push(i[s-1]+l*l)),e[0][s]=S(0,s,a,i),r[0][s]=0;for(var c=1;c<e.length;++c)$(c<e.length-1?c:n-1,n-1,c,e,r,a,i)}(r,n,o);for(var a=[],i=o[0].length-1,l=o.length-1;l>=0;l--){var c=o[l][i];a[l]=r.slice(c,i+1),l>0&&(i=c-1)}return a},t.combinations=function t(e,r){var n,o,a,i,s=[];for(n=0;n<e.length;n++)if(1===r)s.push([e[n]]);else for(a=t(e.slice(n+1,e.length),r-1),o=0;o<a.length;o++)(i=a[o]).unshift(e[n]),s.push(i);return s},t.combinationsReplacement=function t(e,r){for(var n=[],o=0;o<e.length;o++)if(1===r)n.push([e[o]]);else for(var a=t(e.slice(o,e.length),r-1),i=0;i<a.length;i++)n.push([e[o]].concat(a[i]));return n},t.combineMeans=B,t.combineVariances=function(t,e,r,n,o,a){var i=B(e,r,o,a);return(r*(t+Math.pow(e-i,2))+a*(n+Math.pow(o-i,2)))/(r+a)},t.cumulativeStdNormalProbability=function(t){var e=Math.abs(t),r=Math.min(Math.round(100*e),G.length-1);return t>=0?G[r]:+(1-G[r]).toFixed(4)},t.epsilon=N,t.equalIntervalBreaks=function(t,e){if(t.length<2)return t;for(var r=l(t),n=c(t),o=[r],a=(n-r)/e,i=1;i<e;i++)o.push(o[0]+a*i);return o.push(n),o},t.erf=Z,t.errorFunction=Z,t.extent=function(t){if(0===t.length)throw new Error("extent requires at least one data point");for(var e=t[0],r=t[0],n=1;n<t.length;n++)t[n]>r&&(r=t[n]),t[n]<e&&(e=t[n]);return[e,r]},t.extentSorted=function(t){return[t[0],t[t.length-1]]},t.factorial=z,t.gamma=function t(e){if(Number.isInteger(e))return e<=0?NaN:z(e-1);if(--e<0)return Math.PI/(Math.sin(Math.PI*-e)*t(-e));var r=e+1/4;return Math.pow(e/Math.E,e)*Math.sqrt(2*Math.PI*(e+1/6))*(1+1/144/Math.pow(r,2)-1/12960/Math.pow(r,3)-257/207360/Math.pow(r,4)-52/2612736/Math.pow(r,5)+5741173/9405849600/Math.pow(r,6)+37529/18811699200/Math.pow(r,7))},t.gammaln=function(t){if(t<=0)return 1/0;t--;for(var e=C[0],r=1;r<15;r++)e+=C[r]/(t+r);var n=5.2421875+t;return H+Math.log(e)-n+(t+.5)*Math.log(n)},t.geometricMean=function(t){if(0===t.length)throw new Error("geometricMean requires at least one data point");for(var e=1,r=0;r<t.length;r++){if(t[r]<=0)throw new Error("geometricMean requires only positive numbers as input");e*=t[r]}return Math.pow(e,1/t.length)},t.harmonicMean=function(t){if(0===t.length)throw new Error("harmonicMean requires at least one data point");for(var e=0,r=0;r<t.length;r++){if(t[r]<=0)throw new Error("harmonicMean requires only positive numbers as input");e+=1/t[r]}return t.length/e},t.interquartileRange=y,t.inverseErrorFunction=K,t.iqr=y,t.kMeansCluster=function(t,e,r){void 0===r&&(r=Math.random);for(var n=null,o=k(t,e,r),a=null,i=Number.MAX_VALUE;0!==i;)n=o,i=rt(o=et(t,a=tt(t,o),e),n);return{labels:a,centroids:o}},t.kde=V,t.kernelDensityEstimation=V,t.linearRegression=function(t){var e,r,n=t.length;if(1===n)e=0,r=t[0][1];else{for(var o,a,i,s=0,l=0,c=0,p=0,d=0;d<n;d++)s+=a=(o=t[d])[0],l+=i=o[1],c+=a*a,p+=a*i;r=l/n-(e=(n*p-s*l)/(n*c-s*s))*s/n}return{m:e,b:r}},t.linearRegressionLine=function(t){return function(e){return t.b+t.m*e}},t.mad=x,t.max=c,t.maxSorted=function(t){return t[t.length-1]},t.mean=r,t.meanSimple=L,t.median=w,t.medianAbsoluteDeviation=x,t.medianSorted=function(t){return d(t,.5)},t.min=l,t.minSorted=function(t){return t[0]},t.mode=function(t){return i(s(t))},t.modeFast=function(t){for(var e,r=new Map,n=0,o=0;o<t.length;o++){var a=r.get(t[o]);void 0===a?a=1:a++,a>n&&(e=t[o],n=a),r.set(t[o],a)}if(0===n)throw new Error("mode requires at last one data point");return e},t.modeSorted=i,t.numericSort=s,t.perceptron=j,t.permutationTest=function(t,e,n,o,a){if(void 0===o&&(o=1e4),void 0===n&&(n="two_side"),"two_side"!==n&&"greater"!==n&&"less"!==n)throw new Error("`alternative` must be either 'two_side', 'greater', or 'less'");for(var i=r(t)-r(e),s=new Array(o),l=t.concat(e),c=Math.floor(l.length/2),p=0;p<o;p++){_(l,a);var d=l.slice(0,c),h=l.slice(c,l.length),f=r(d)-r(h);s[p]=f}var u=0;if("two_side"===n)for(var g=0;g<=o;g++)Math.abs(s[g])>=Math.abs(i)&&(u+=1);else if("greater"===n)for(var m=0;m<=o;m++)s[m]>=i&&(u+=1);else for(var v=0;v<=o;v++)s[v]<=i&&(u+=1);return u/o},t.permutationsHeap=function(t){for(var e=new Array(t.length),r=[t.slice()],n=0;n<t.length;n++)e[n]=0;for(var o=0;o<t.length;)if(e[o]<o){var a=0;o%2!=0&&(a=e[o]);var i=t[a];t[a]=t[o],t[o]=i,r.push(t.slice()),e[o]++,o=0}else e[o]=0,o++;return r},t.poissonDistribution=function(t){if(!(t<=0)){var e=0,r=0,n=[],o=1;do{n[e]=Math.exp(-t)*Math.pow(t,e)/o,r+=n[e],o*=++e}while(r<.9999);return n}},t.probit=function(t){return 0===t?t=N:t>=1&&(t=.9999),Math.sqrt(2)*K(2*t-1)},t.product=function(t){for(var e=1,r=0;r<t.length;r++)e*=t[r];return e},t.quantile=u,t.quantileRank=function(t,e){return b(s(t),e)},t.quantileRankSorted=b,t.quantileSorted=d,t.quickselect=h,t.rSquared=function(t,e){if(t.length<2)return 1;for(var r=0,n=0;n<t.length;n++)r+=t[n][1];for(var o=r/t.length,a=0,i=0;i<t.length;i++)a+=Math.pow(o-t[i][1],2);for(var s=0,l=0;l<t.length;l++)s+=Math.pow(t[l][1]-e(t[l][0]),2);return 1-s/a},t.relativeError=it,t.rms=O,t.rootMeanSquare=O,t.sample=k,t.sampleCorrelation=function(t,e){return q(t,e)/P(t)/P(e)},t.sampleCovariance=q,t.sampleKurtosis=function(t){var e=t.length;if(e<4)throw new Error("sampleKurtosis requires at least four data points");for(var n,o=r(t),a=0,i=0,s=0;s<e;s++)a+=(n=t[s]-o)*n,i+=n*n*n*n;return(e-1)/((e-2)*(e-3))*(e*(e+1)*i/(a*a)-3*(e-1))},t.sampleSkewness=function(t){if(t.length<3)throw new Error("sampleSkewness requires at least three data points");for(var e,n=r(t),o=0,a=0,i=0;i<t.length;i++)o+=(e=t[i]-n)*e,a+=e*e*e;var s=t.length-1,l=Math.sqrt(o/s),c=t.length;return c*a/((c-1)*(c-2)*Math.pow(l,3))},t.sampleStandardDeviation=P,t.sampleVariance=T,t.sampleWithReplacement=function(t,e,r){if(0===t.length)return[];r=r||Math.random;for(var n=t.length,o=[],a=0;a<e;a++){var i=Math.floor(r()*n);o.push(t[i])}return o},t.shuffle=M,t.shuffleInPlace=_,t.sign=J,t.silhouette=nt,t.silhouetteMetric=function(t,e){return c(nt(t,e))},t.standardDeviation=a,t.standardNormalTable=G,t.subtractFromMean=function(t,e,r){return(t*e-r)/(e-1)},t.sum=e,t.sumNthPowerDeviations=n,t.sumSimple=p,t.tTest=function(t,e){return(r(t)-e)/(a(t)/Math.sqrt(t.length))},t.tTestTwoSample=function(t,e,n){var o=t.length,a=e.length;if(!o||!a)return null;n||(n=0);var i=r(t),s=r(e),l=T(t),c=T(e);if("number"==typeof i&&"number"==typeof s&&"number"==typeof l&&"number"==typeof c){var p=((o-1)*l+(a-1)*c)/(o+a-2);return(i-s-n)/Math.sqrt(p*(1/o+1/a))}},t.uniqueCountSorted=E,t.variance=o,t.zScore=function(t,e,r){return(t-e)/r},Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,r){"use strict";r.r(e);var n=r(2),o=r.n(n);const a={android:()=>navigator.userAgent.match(/Android/i),blackberry:()=>navigator.userAgent.match(/BlackBerry/i),ios:()=>navigator.userAgent.match(/iPhone|iPad|iPod/i),opera:()=>navigator.userAgent.match(/Opera Mini/i),windows:()=>navigator.userAgent.match(/IEMobile/i),any:()=>a.android()||a.blackberry()||a.ios()||a.opera()||a.windows()};var i=a;function s(){(function(t,e=document){return[...e.querySelectorAll(t)]})("[target='_blank']").forEach(t=>t.setAttribute("rel","noopener"))}var l=r(0),c=r.n(l),p=r(1),d=r.n(p);const h="assets/images",f=d3.select("#warren-scroll"),u=f.select(".scroll__img"),g=f.selectAll(".step"),m=u.select(".warren-img"),v=f.select(".intro"),b=c()();let y,w="cold-night";const x={"cold-night":()=>{m.attr("src",h+"/cold-night.jpg").transition().duration(1e3).style("transform","scale(1)"),y||v.transition().duration(2e3).style("opacity",0)},chase:()=>{m.attr("src",h+"/chase.jpg").style("transform","scale(1)")},arrest:()=>{m.attr("src",h+"/arrest.jpg").style("transform","scale(1)")}};function _({index:t,element:e,direction:r}){w=d3.select(e).attr("data-step"),x[w]()}function M({index:t,element:e,direction:r}){0!=t||"up"!=r||y||(v.transition().duration(1e3).style("opacity",1),m.transition().duration(2e3).style("transform","scale(2.5)"))}var k={init:function(){m.attr("src",h+"/cold-night.jpg"),function(){d.a.add(u.node()),window.innerHeight;const t=window.innerWidth;y=t<=600,b.setup({step:g.nodes(),offset:y?Math.floor(.8*window.innerHeight)+"px":.8}).onStepEnter(_).onStepExit(M)}()},resize:function(){}};function A(t){return new Promise((e,r)=>{const n=t.split(".").pop();"csv"===n?d3.csv("assets/data/"+t).then(e).catch(r):"json"===n|"geojson"===n?d3.json("assets/data/"+t).then(e).catch(r):r(new Error("unsupported file type for: "+t))})}function E(t){if("string"==typeof t)return A(t);const e=t.map(A);return Promise.all(e)}const S=d3.select("#declined"),$=S.select(".graphic"),q=S.selectAll(".paragraph"),T=$.select("svg"),P=T.select(".chart"),B=T.select(".x-axis"),L=T.select(".y-axis"),O=30,I=10,j=50,N=60;let z,C=0,H=0,R=0,W=0;const F=d3.scaleBand(),D=d3.scaleLinear();let V,Y,X;const G=c()();let U="0";const Z={0:()=>{J()},1:()=>{}};function K(){const t=d3.select(this).select("path"),e=t.node().getTotalLength();t.attr("stroke-dasharray",`${e} ${e}`).attr("stroke-dashoffset",e)}function J(){P.selectAll(".label").remove(),F.domain(X.map(t=>t.year)),D.domain([0,d3.max(X,t=>t.number_of_fio_subjects)]);const t=z?d3.axisBottom(F).tickValues(["2006","2008","2010","2012","2014","2016","2018"]):d3.axisBottom(F);V=B.attr("transform",`translate(${N}, ${O+W})`).call(t),Y=L.attr("transform",`translate(${N}, ${O})`).call(d3.axisLeft(D).tickSize(-R).ticks(5));P.append("text").attr("class","label y-label").selectAll("tspan").data(["Number","of","people"]).enter().append("tspan").text(t=>t).attr("x",-35).attr("y",(t,e)=>-O/2+10*e);P.append("text").attr("class","label","x-label").text("Year").attr("transform",`translate(${R/2}, ${W+40})`).attr("text-anchor","middle");const e=d3.line().x(t=>F(t.year)).y(t=>D(t.number_of_fio_subjects)).curve(d3.curveMonotoneX),r=P.selectAll(".subject-num").data([X]),n=r.enter().append("g").attr("class","subject-num");n.append("path");const o=n.merge(r);o.select("path").datum(t=>t).attr("d",e),o.each(K),o.select("path").transition().duration(3e3).attr("stroke-dashoffset",0);const a=P.selectAll(".subject-num-circle").data(X);a.enter().append("circle").attr("class","subject-num-circle").merge(a);P.selectAll("circle").attr("cx",t=>F(t.year)).attr("cy",t=>D(t.number_of_fio_subjects)).attr("r",2)}function Q(){!function(){const t=window.innerHeight,e=window.innerWidth;z=e<=600,C=z?Math.floor(.6*t):Math.floor(.5*t),H=$.node().offsetWidth}(),T.attr("height",C).attr("width",H),P.attr("transform",`translate(${N}, ${O})`),R=H-N-I,W=C-O-j,F.range([0,R]),D.range([W,0]),J()}function tt({index:t,element:e,direction:r}){U=""+t,Z[U]()}var et={init:function(){E("number_of_fio_subjects_by_year.csv").then(t=>{console.log(t),X=t,Q(),G.setup({step:q.nodes(),offset:.6}).onStepEnter(tt)}).catch(console.error)},resize:Q};const rt=d3.select("#black"),nt=rt.select(".graphic"),ot=(rt.selectAll(".paragraph"),nt.select("svg")),at=ot.select(".graphic__chart"),it=at.select(".chart__pop"),st=at.select(".chart__stop"),lt=20,ct=40,pt=20,dt=20;let ht,ft=0,ut=0,gt=0,mt=0;const vt=[{race:"Black",0:0,1:.2507},{race:"white",0:.25075,1:.7642},{race:"others",0:.7642,1:1}],bt=[{race:"Black",0:0,1:.69},{race:"white",0:.69,1:.94},{race:"others",0:.94,1:1}];c()();const yt=d3.scaleLinear(),wt=d3.scaleBand();function xt(){!function(){const t=window.innerHeight,e=window.innerWidth;ht=e<=600,ft=ht?Math.floor(.4*t):Math.floor(.3*t),ut=nt.node().offsetWidth,gt=ut-dt-ct,mt=ft-lt-pt}(),ot.attr("height",ft).attr("width",ut),at.attr("transform",`translate(${dt}, ${lt})`),yt.range([0,gt]),wt.range([0,mt]),it.selectAll(".pop-bars").remove(),st.selectAll(".stop-bars").remove(),ot.selectAll(".stacked-bar-title").remove(),ot.selectAll(".stacked-bar-legend").remove(),function(){yt.domain([0,1]),wt.domain(["pop","stop"]).paddingInner(.5);const t=d3.scaleOrdinal().domain(["Black","white","others"]).range(["#81A8AD","#E8AA46","#C4C4C4"]),e=it.selectAll(".pop-bars").data([vt]);e.enter().append("g").attr("class","pop-bars").merge(e).selectAll("rect").data(t=>t).enter().append("rect").attr("x",t=>yt(t[0])).attr("y",wt("pop")).attr("width",t=>yt(t[1])-yt(t[0])-2).attr("height",wt.bandwidth()).attr("fill",e=>t(e.race)),it.append("text").attr("class","stacked-bar-title").text("Boston Population by Race").attr("y",wt("pop")-5),it.selectAll(".stacked-bar-legend").data(vt).enter().append("text").attr("class","stacked-bar-legend").text(t=>ht?""+t.race:`${t.race}: ${Math.round(1e4*(t[1]-t[0]))/100}%`).attr("y",wt("pop")+wt.bandwidth()+10).attr("x",t=>yt(t[0]));const r=st.selectAll(".stop-bars").data([bt]);r.enter().append("g").attr("class","stop-bars").merge(r).selectAll("rect").data(t=>t).enter().append("rect").attr("x",t=>yt(t[0])).attr("y",wt("stop")).attr("width",t=>yt(t[1])-yt(t[0])-2).attr("height",wt.bandwidth()).attr("fill",e=>t(e.race)),st.append("text").attr("class","stacked-bar-title").text("Stopped Indivisual by Race").attr("y",wt("stop")-5),st.selectAll(".stacked-bar-legend").data(bt).enter().append("text").attr("class","stacked-bar-legend").text(t=>ht?""+t.race:`${t.race}: ${Math.round(1e4*(t[1]-t[0]))/100}%`).attr("y",wt("stop")+wt.bandwidth()+10).attr("x",t=>yt(t[0]))}()}var _t={init:function(){xt()},resize:xt};r(4);const Mt=d3.select("#scatter"),kt=Mt.select(".scroll__graphic");var At=Mt.select(".tool-tip");const Et=Mt.select(".scroll__text").selectAll(".step"),St=kt.select("svg"),$t=St.select(".vis"),qt=St.select(".x-axis"),Tt=St.select(".y-axis");let Pt=0,Bt=0;const Lt=20,Ot=10,It=50,jt=30;let Nt,zt,Ct=window.innerHeight,Ht=window.innerWidth,Rt=Ht<=600;const Wt=d3.scaleLinear(),Ft=d3.scaleLinear();let Dt,Vt,Yt;function Xt(){return d3.scaleOrdinal().domain(Yt.map(t=>t.Name)).range(["#3957ff","#c9080a","#fec7f8","#0b7b3e","#0bf0e9","#c203c8","#fd9b39","#888593","#906407","#98ba7f","#fe6794","#10b0ff","#ac7bff","#fee7c0","#964c63","#1da49c","#0ad811","#bbd9fd","#fe6cfe","#297192","#d1a09c","#78579e","#81ffad","#739400","#ca6949","#d9bf01","#646a58","#d5097e","#bb73a9"])}function Gt(){$t.selectAll(".neighborhood").remove(),$t.selectAll(".more-black-text").remove(),$t.selectAll(".more-white-text").remove(),$t.selectAll(".label").remove(),$t.selectAll(".usa-average").remove(),Wt.domain(d3.extent(Yt,t=>t.crime)),Ft.domain(d3.extent(Yt,t=>t.stopped_per)),Dt=qt.attr("transform",`translate(${jt}, ${Lt+zt})`).call(d3.axisBottom(Wt)),Vt=Tt.attr("transform",`translate(${jt}, ${Lt})`).call(d3.axisLeft(Ft).tickSize(-Nt).ticks(5));$t.append("text").attr("class","label y-label").selectAll(".y-label-tspan").data(["Stops","per","100 people"]).enter().append("tspan").text(t=>t).attr("x",-10).attr("y",(t,e)=>-Lt/2+15*e);$t.append("text").attr("class","label","x-label").text("Crime Index").attr("transform",`translate(${Nt/2}, ${Pt-20})`).attr("text-anchor","middle");const t=$t.append("g").attr("class","usa-average");t.append("line").attr("x1",Wt(100)).attr("x2",Wt(100)).attr("y1",zt).attr("y2",0).attr("stroke","rgba(0,0,0,0.5)").attr("stroke-dasharray","4 1"),t.append("text").text("USA average").attr("x",Wt(101)).attr("y",Ft(3.5)).attr("fill","rgba(0,0,0,0.5)");Xt();const e=$t.selectAll(".neighborhood").data(Yt);e.enter().append("circle").attr("class","neighborhood").attr("cx",t=>Wt(t.crime)).attr("cy",t=>Ft(t.stopped_per)).attr("r",5).attr("fill",t=>t.color).on("mouseover",(function(t){const e=d3.select(this).attr("cx"),r=d3.select(this).attr("cy"),n=d3.select(this).datum();At.style("left",e+"px").style("top",r+"px").style("visibility","visible").html((function(){return"<div><p>"+n.neighborhood+"</p></div>"}))})).on("mouseout",(function(t){At.style("visibility","hidden")})).merge(e);$t.selectAll(".neighborhood-text").data(Yt).enter().append("text").attr("class",t=>+t["%black"]/100>=.5?"more-black-text":"Brighton"==t.neighborhood||"Allston"==t.neighborhood||"East Boston"==t.neighborhood||"North End"==t.neighborhood?"more-white-text":void 0).text(t=>+t["%black"]/100>=.5||"Brighton"==t.neighborhood||"Allston"==t.neighborhood||"East Boston"==t.neighborhood||"North End"==t.neighborhood?t.neighborhood:void 0).attr("x",t=>Wt(t.crime)-15).attr("y",t=>Ft(t.stopped_per)-6).attr("font-size",12).attr("font-family","Helvetica").attr("opacity",0).attr("text-anchor","middle")}const Ut=c()();let Zt="explain";const Kt={explain:()=>{$t.select(".usa-average").attr("opacity",1),$t.selectAll(".neighborhood").attr("fill",t=>t.color),$t.selectAll(".more-white-text").attr("opacity",0),$t.selectAll(".more-black-text").attr("opacity",0)},"high-crime":()=>{$t.select(".usa-average").attr("opacity",0);Xt();$t.selectAll(".neighborhood").attr("fill",t=>+t["%black"]/100>=.5?t.color:"rgba(0,0,0,0.1)"),$t.selectAll(".more-black-text").attr("opacity",1),$t.selectAll(".more-white-text").attr("opacity",0)},exceptions:()=>{Xt();$t.selectAll(".neighborhood").attr("fill",t=>"Brighton"==t.neighborhood||"Allston"==t.neighborhood||"East Boston"==t.neighborhood||"North End"==t.neighborhood?t.color:"rgba(0,0,0,0.1)"),$t.selectAll(".more-black-text").attr("opacity",0),$t.selectAll(".more-white-text").attr("opacity",1)}};function Jt({index:t,element:e,direction:r}){Zt=d3.select(e).attr("data-step"),Kt[Zt]()}function Qt(){Ct=window.innerHeight,Ht=window.innerWidth,Rt=Ht<=600,Pt=Rt?Math.floor(.6*Ct):Math.floor(.7*Ct),Bt=kt.node().offsetWidth,Nt=Bt-jt-Ot,zt=Pt-Lt-It,St.attr("width",Bt).attr("height",Pt),$t.attr("transform",`translate(${jt}, ${Lt})`),Wt.range([0,Nt]),Ft.range([zt,0]),Gt()}var te={init:function(){E("shape_with_stops.csv").then(t=>{Yt=t.filter(t=>+t.resident_employee_ratio>=1&&""!==t.ZIP5),Yt.map(t=>{t.crime=+t.crime,t.stopped_per=+t.stopped_per,t.neighborhood=t.Name.split(", ")[1]}),Yt.sort((t,e)=>t.crime-e.crime),console.log(Yt),Qt(),Gt(),d.a.add(kt.node()),Ut.setup({step:Et.nodes(),offset:Rt?Math.floor(.5*window.innerHeight)+"px":.5}).onStepEnter(Jt)}).catch(console.error)},resize:Qt};var ee=new ArrayBuffer(16);new Float64Array(ee),new Uint32Array(ee);Math.PI,Math.abs,Math.atan2,Math.cos,Math.sin;let re,ne;function oe(){}var ae={init:function(){E(["shape_with_stops.csv","ZIP_Codes.json"]).then(t=>{re=t[0].filter(t=>+t.resident_employee_ratio>=1),ne=t[1],ne.objects["ZIP_Codes (1)"].geometries.forEach(t=>{re.forEach(e=>{"0"+String(e.zip)==t.properties.ZIP5&&(t.properties.total_population=+e.population,t.properties.black_pop=+e.black_pop,t.properties.white_pop=+e.white_pop,t.properties.percent_black=+e["%black"],t.properties.percent_white=+e["%white"],t.properties.num_of_stop=+e.num_of_stops,t.properties.stopped_per=+e.stopped_per,t.properties.per_black_stopped_within_blacks=+e.per_black_stopped_within_blacks,t.properties.per_white_stopped_within_whites=+e.per_white_stopped_within_whites,t.properties.crime=+e.crime,t.properties.neighborhood=+e.Name.split(", ")[1])})})}).catch(console.error)},resize:oe};var ie={init:function(){},resize:function(){}};const se=d3.select("#large-black"),le=se.select(".select-person-intro").select(".paragraph"),ce=se.select(".select-person-intro").select(".button-group"),pe=ce.select(".left-person"),de=ce.select(".right-person"),he=se.select(".select-person-intro").select(".assigned-person"),fe=se.select(".scroll__graphic").select(".graphic"),ue=(d3.select("#declined .graphic"),fe.select("svg").select(".chart")),ge=se.select(".scroll__text").selectAll(".step"),me=ge.select(".overall-boston"),ve=ge.select(".your-neighborhood-chance"),be=fe.select(".tool-tip"),ye=d3.select("#stop-by-race"),we=ye.select(".stop-by-race-intro").select(".paragraph p"),xe=ye.select(".scroll__text").selectAll(".step"),_e=xe.select(".remind-race"),Me=xe.select(".your-race-in-boston"),ke=xe.select(".if-another"),Ae=ye.select(".scroll__graphic").select(".graphic"),Ee=Ae.select("svg").select(".chart");let Se,$e,qe,Te,Pe,Be,Le,Oe,Ie;const je=c()(),Ne=c()();let ze="assigned-person",Ce="remind-race";const He={"assigned-person":()=>{},"overall-boston":()=>{ue.selectAll(".stop-bar").attr("opacity",.05),ue.selectAll(".boston-avg").attr("opacity",1)},"black-pop":()=>{},"your-neighborhood-chance":()=>{ue.selectAll(".stop-bar").attr("opacity",.05),ue.selectAll(".boston-avg").attr("opacity",0),"black"==Se?ue.select("#stop-bar-2119").attr("opacity",1):ue.select("#stop-bar-2134").attr("opacity",1),be.style("visibility","hidden")},explain:()=>{ue.selectAll(".stop-bar").attr("opacity",.05).on("mouseover",()=>{}),ue.select("#stop-bar-2119").attr("opacity",1),ue.select("#stop-bar-2121").attr("opacity",1)},explore:()=>{ue.selectAll(".stop-bar").attr("opacity",1),ue.selectAll(".stop-bar").on("mouseover",t=>{be.style("left",t.clientX+"px").style("top",t.clientY+"px").style("visibility","visible");const e="boston"===t.target.id?"boston":t.target.id.split("-")[2];if("boston"===e)be.html("Boston: 1%");else{const t=Oe.filter(t=>t.zip==e)[0];be.html(`${t.neighborhood}: ${Math.round(100*t.stopped_per)/100}%`)}})}},Re={"remind-race":()=>{Ee.selectAll(".slope-circle").attr("opacity",1).attr("r",5).style("stroke-width",1),Ee.selectAll(".slope-line").attr("opacity",1),Ee.selectAll(".byside-circle-legend").attr("opacity",1)},"your-race-in-boston":()=>{Ee.selectAll(".slope-circle").attr("opacity",.1),Ee.selectAll(".slope-line").attr("opacity",.1),Ee.selectAll(".byside-circle-legend").attr("opacity",0),"black"===Se?Ee.select("#black-circle-2119").attr("opacity",1).attr("r",8).style("stroke-width",2):Ee.select("#white-circle-2134").attr("opacity",1).attr("r",8).style("stroke-width",2)},"if-another":()=>{Ee.selectAll(".slope-circle").attr("opacity",.1).attr("r",5).style("stroke-width",1),Ee.selectAll(".slope-line").attr("opacity",.1),Ee.selectAll(".byside-circle-legend").attr("opacity",0),"black"===Se?(Ee.select("#slope-line-2119").attr("opacity",1),Ee.select("#black-circle-2119").attr("opacity",1),Ee.select("#white-circle-2119").attr("opacity",1).attr("r",8).style("stroke-width",2)):(Ee.select("#slope-line-2134").attr("opacity",1),Ee.select("#white-circle-2134").attr("opacity",1),Ee.select("#black-circle-2134").attr("opacity",1).attr("r",8).style("stroke-width",2))},"more-black-area":()=>{Ee.selectAll(".slope-circle").attr("opacity",.1).attr("r",5).style("stroke-width",1),Ee.selectAll(".slope-line").attr("opacity",.1),Ee.select("#slope-line-2119").attr("opacity",1),Ee.select("#white-circle-2119").attr("opacity",1),Ee.select("#black-circle-2119").attr("opacity",1),Ee.select("#slope-line-2121").attr("opacity",1),Ee.select("#white-circle-2121").attr("opacity",1),Ee.select("#black-circle-2121").attr("opacity",1),Ee.selectAll(".byside-circle-legend").attr("opacity",0)},mattapan:()=>{Ee.selectAll(".slope-circle").attr("opacity",.1).attr("r",5).style("stroke-width",1),Ee.selectAll(".slope-line").attr("opacity",.1),Ee.select("#slope-line-2126").attr("opacity",1),Ee.select("#white-circle-2126").attr("opacity",1),Ee.select("#black-circle-2126").attr("opacity",1),Ee.selectAll(".byside-circle-legend").attr("opacity",0)},"more-white-area":()=>{Ee.selectAll(".slope-circle").attr("opacity",.1).attr("r",5).style("stroke-width",1),Ee.selectAll(".slope-line").attr("opacity",.1),Ee.select("#slope-line-2134").attr("opacity",1),Ee.select("#white-circle-2134").attr("opacity",1),Ee.select("#black-circle-2134").attr("opacity",1),Ee.select("#slope-line-2135").attr("opacity",1),Ee.select("#white-circle-2135").attr("opacity",1),Ee.select("#black-circle-2135").attr("opacity",1),Ee.select("#slope-line-2129").attr("opacity",1),Ee.select("#white-circle-2129").attr("opacity",1),Ee.select("#black-circle-2129").attr("opacity",1),Ee.selectAll(".byside-circle-legend").attr("opacity",0)},"explore-race":()=>{Ee.selectAll(".slope-circle").attr("opacity",1).attr("r",5).style("stroke-width",1),Ee.selectAll(".slope-line").attr("opacity",1),Ee.selectAll(".byside-circle-legend").attr("opacity",1)}};function We(){$e="black"===Se?"white":"black",d3.selectAll(".graphic").style("display","block"),d3.selectAll(".scroll__text").style("display","block"),d3.selectAll(".conclusion").style("display","block"),ye.style("display","block"),le.style("display","block"),d3.select("#by-race-conclusion").style("display","block"),d3.select("#conclude").style("display","block"),Ve();const t="black"==Se?"Black":"white";he.html(`You are a <span class="white-underscore">${t}</span> resident living in <span class="white-underscore">${qe.split(", ")[0]}, ${qe.split(", ")[1]}</span>`),me.style("opacity",1),Ie=Oe.filter(t=>t.Name===qe),Te=Ie[0]["%black"],Pe=Ie[0]["%white"],Be=Ie[0].per_black_stopped_within_blacks,Le=Ie[0].per_white_stopped_within_whites;const e=Ie[0].stopped_per-1>0?"increase":"decrease";ve.html(`However, since you live in ${qe}, where ${Math.round(Te)}% of population is Black and ${Math.round(Pe)}% of population is white, your chances of getting stopped by the police ${e} to <span class='selected-neighborhood'>${Math.round(100*Ie[0].stopped_per)/100}%</span>.`),we.html(`Now, lets take your race into consideration. In some areas, being ${t} does affect your chance of being stopped by the police. `),_e.html(`As a ${t} person living in ${qe}...`);const r="black"==Se?Math.round(100*Ie[0].per_black_stopped_within_blacks)/100:Math.round(100*Ie[0].per_white_stopped_within_whites)/100;Me.html(`...you have a <span class=${Se}-color>${r}%</span> chance of being stopped by the police.`);const n="black"==Se?Math.round(100*Ie[0].per_white_stopped_within_whites)/100:Math.round(100*Ie[0].per_black_stopped_within_blacks/100);ke.html(`That number changes to <span class=${$e}-color>${Math.round(100*n)/100}% </span> if youre <span class=${$e}-color>${$e}</span>.`)}function Fe({index:t,element:e,direction:r}){Ce=d3.select(e).attr("data-step"),Re[Ce]()}function De({index:t,element:e,direction:r}){ze=d3.select(e).attr("data-step"),He[ze]()}function Ve(){}var Ye={init:function(){E("shape_with_stops.csv").then(t=>{Oe=t.filter(t=>+t.resident_employee_ratio>=1),Oe.map(t=>{"Dorchester"===t.Name.split(", ")[1]?t.neighborhood=`${t.Name.split(", ")[1]}(${t.Name.split(", ")[0]})`:t.neighborhood=""+t.Name.split(", ")[1],t.crime=+t.crime,t.stopped_per=+t.stopped_per}),Oe.sort((t,e)=>+e.stopped_per-+t.stopped_per),d.a.add(fe.node()),d.a.add(Ae.node()),je.setup({step:ge.nodes(),offset:.5}).onStepEnter(De),Ne.setup({step:xe.nodes(),offset:.5}).onStepEnter(Fe),pe.on("click",()=>{Se="black",qe="02119, Roxbury, MA",We(),pe.classed("selected-person",!0),de.classed("selected-person",!1)}),de.on("click",()=>{Se="white",qe="02134, Allston, MA",We(),pe.classed("selected-person",!1),de.classed("selected-person",!0)})})},resize:Ve};const Xe=d3.select("#large-black").select(".graphic"),Ge=d3.select("#declined .graphic"),Ue=Xe.select("svg"),Ze=Ue.select(".chart"),Ke=Ue.select(".legend");let Je=0,Qe=0;const tr=150,er=10,rr=100,nr=100;let or,ar,ir,sr;const lr=d3.scaleLinear(),cr=d3.scaleBand(),pr=d3.scaleLinear();function dr(){!function(){const t=window.innerHeight,e=window.innerWidth;ir=e<=600,Je=ir?Math.floor(.9*t):Math.floor(.95*t),Qe=Ge.node().offsetWidth,or=Je-tr-rr,ar=Qe-nr-er}(),Ue.attr("width",Qe).attr("height",Je),Ze.attr("transform",`translate(${nr}, ${tr})`),function(t){Ze.selectAll("*").remove(),Ke.selectAll("*").remove(),lr.domain(d3.extent(sr,t=>+t.stopped_per)).range([0,ar]),Ze.append("g").attr("class","axis x-axis").attr("transform",`translate(0, ${or})`).call(d3.axisBottom(lr).tickSize(-or).ticks(5).tickFormat(t=>t+"%")).selectAll("text").style("text-anchor","middle"),Ze.append("g").attr("transform",`translate(${ar/2}, ${or+30})`).append("text").attr("text-anchor","middle").attr("class","label x-label").text("Chances of getting stopped"),cr.range([0,or]).domain(sr.map((function(t){return t.neighborhood}))).padding(.1),Ze.append("g").attr("class","axis y-axis").call(d3.axisLeft(cr)),pr.domain(d3.extent(sr,t=>+t["%black"])).range(["#E8AA46","#81A8AD"]),Ze.selectAll("rect").data(sr).enter().append("rect").attr("class","stop-bar").attr("id",t=>"2134"===t.zip?"stop-bar-2134":"2119"===t.zip?"stop-bar-2119":"2121"===t.zip?"stop-bar-2121":void 0).attr("x",lr(0)).attr("y",(function(t){return cr(t.neighborhood)})).attr("width",(function(t){return lr(t.stopped_per)})).attr("height",cr.bandwidth()).attr("fill",t=>pr(t["%black"])),Ze.append("line").attr("class","boston-avg").attr("x1",lr(1)).attr("x2",lr(1)).attr("y1",or).attr("y2",0).attr("stroke","rgba(0,0,0,0.8)"),Ze.append("text").attr("class","boston-avg").text("Boston Average").attr("x",lr(1.1)).attr("y",or/2);const e=[{color:pr.range()[0],value:pr.domain()[0]},{color:pr.range()[1],value:pr.domain()[1]}];var r=d3.extent(e,t=>t.value);Ue.append("defs").append("linearGradient").attr("id","legendGradient").selectAll("stop").data(e).enter().append("stop").attr("offset",t=>(t.value-r[0])/(r[1]-r[0])*100+"%").attr("stop-color",t=>t.color);const n=ir?.8*ar:.5*ar,o=ir?15:25,a=ir?20:50;Ke.attr("transform",`translate(${nr}, ${tr-o-a})`),Ke.append("rect").attr("class","legend-rect").attr("x",ar/2-n/2).attr("width",n).attr("height",o).style("fill","url(#legendGradient)"),Ke.append("text").text("Demographics").attr("y",-5).attr("x",ar/2-n/2).attr("class","legend-text"),Ke.append("text").text("more Whites").attr("x",ar/2-n/2).attr("y",o+10).attr("class","legend-text"),Ke.append("text").text("more Blacks").attr("x",ar/2-n/2+n).attr("y",o+10).attr("text-anchor","end").attr("class","legend-text")}()}var hr={init:function(){E("shape_with_stops.csv").then(t=>{sr=t.filter(t=>+t.resident_employee_ratio>=1),sr.map(t=>{t.neighborhood=""+t.Name.split(", ")[1]}),sr.sort((t,e)=>+e.stopped_per-+t.stopped_per),dr()})},resize:dr};const fr=d3.select("#stop-by-race").select(".scroll .scroll__graphic .graphic"),ur=d3.select("#declined .graphic"),gr=fr.select("svg"),mr=gr.select(".chart"),vr=gr.select(".border-lines");var br=gr.select(".title");let yr=0,wr=0;const xr=150,_r=10,Mr=30,kr=100;let Ar;const Er=5,Sr=0;let $r,qr,Tr;const Pr=d3.scaleBand(),Br=d3.scaleLinear(),Lr=d3.scaleLinear();function Or(){!function(){const t=window.innerHeight,e=window.innerWidth;Ar=e<=600,yr=Ar?Math.floor(.9*t):Math.floor(.95*t),wr=ur.node().offsetWidth,$r=yr-xr-Mr,qr=wr-kr-_r}(),gr.attr("width",wr).attr("height",yr),mr.attr("transform",`translate(${kr}, ${xr})`),function(t){vr.selectAll("*").remove(),br.selectAll("text").remove(),mr.selectAll("*").remove(),Br.domain([0,d3.max(t,t=>t.per_white_stopped_within_whites)]).range([0,qr]),mr.append("g").attr("class","axis x-axis").attr("transform",`translate(0, ${$r})`).call(d3.axisBottom(Br).tickSize(-$r).tickValues([2,4,6]).tickFormat(t=>t+"%")).selectAll("text").style("text-anchor","middle"),Pr.range([$r,0]).domain(t.map(t=>t.neighborhood)).padding(.2),Lr.domain(d3.extent(Tr,t=>+t["%black"])).range(["#E8AA46","#81A8AD"]),vr.append("line").attr("id","border-line-left").attr("x1",kr).attr("y1",xr).attr("x2",kr).attr("y2",xr+$r).attr("stroke","rgba(0,0,0,0.5"),vr.append("line").attr("id","border-line-right").attr("x1",kr+qr).attr("y1",xr).attr("x2",kr+qr).attr("y2",xr+$r).attr("stroke","rgba(0,0,0,0.5");const e=Ar?-40:0,r=mr.append("g").attr("class","circle-legend-group").attr("transform",`translate(${e}, ${-xr/2})`).selectAll(".circle-legend").data(["white","Black"]);r.enter().append("text").text(t=>t).attr("y",(t,e)=>Ar?20*e+5:10).attr("x",(t,e)=>Ar?5:0==e?-35:45),r.enter().append("circle").attr("class","circle-legend").attr("fill",t=>"white"==t?"white":"black").attr("stroke",t=>"white"==t?"black":"none").attr("cy",(t,e)=>Ar?20*e:5).attr("r",5).attr("cx",(t,e)=>Ar?0:0==e?-40:40);const n=mr.selectAll(".slope-group").data(t).enter().append("g").attr("class","slope-group").attr("id",(function(t,e){t.id="group"+e}));n.append("line").attr("class","slope-line").attr("id",t=>"slope-line-"+t.zip).attr("x1",t=>Br(t.per_white_stopped_within_whites)).attr("y1",(function(t){return Pr(t.neighborhood)})).attr("x2",t=>Br(t.per_black_stopped_within_blacks)).attr("y2",(function(t){return Pr(t.neighborhood)})).attr("stroke",t=>Lr(t["%black"])).attr("fill","none").attr("stroke-width",5),n.append("circle").attr("class","slope-circle white-slope-circle").attr("id",t=>"white-circle-"+t.zip).attr("r",5).attr("cx",t=>Br(t.per_white_stopped_within_whites)).attr("cy",t=>Pr(t.neighborhood)),n.append("g").attr("class","slope-label slope-label-left").each((function(t){t.xLeftPosition=-Er,t.yLeftPosition=Pr(t.per_white_stopped_within_whites)})).append("text").attr("class","slope-label-left-text").attr("id",t=>"left-label-"+t.zip).attr("x",t=>t.xLeftPosition).attr("y",t=>Pr(t.neighborhood)).attr("dx",-Sr).attr("dy",3).attr("text-anchor","end").text(t=>t.neighborhood),n.append("circle").attr("class","slope-circle black-slope-circle").attr("id",t=>"black-circle-"+t.zip).attr("r",5).attr("cx",t=>Br(t.per_black_stopped_within_blacks)).attr("cy",t=>Pr(t.neighborhood)).attr("fill",t=>Lr(t["%black"]));const o=d3.select("#white-circle-2126").attr("cx"),a=d3.select("#white-circle-2126").attr("cy"),i=d3.select("#black-circle-2126").attr("cx"),s=d3.select("#black-circle-2126").attr("cy");mr.append("text").text("White").attr("class","byside-circle-legend").attr("x",o).attr("dx",7).attr("y",a).attr("dy",5),mr.append("text").text("Black").attr("class","byside-circle-legend").attr("x",i).attr("dx",-7).attr("y",s).attr("dy",5).attr("text-anchor","end");const l=[{color:Lr.range()[0],value:Lr.domain()[0]},{color:Lr.range()[1],value:Lr.domain()[1]}];var c=d3.extent(l,t=>t.value);gr.append("defs").append("linearGradient").attr("id","legendGradient").selectAll("stop").data(l).enter().append("stop").attr("offset",t=>(t.value-c[0])/(c[1]-c[0])*100+"%").attr("stop-color",t=>t.color);const p=Ar?.8*qr:.5*qr,d=Ar?10:20,h=mr.append("g").attr("class","legend");h.attr("transform",`translate(${qr-p}, ${-xr/2-d/2})`),h.append("rect").attr("class","legend-rect").attr("x",0).attr("width",p).attr("height",d).style("fill","url(#legendGradient)"),h.append("text").text("Demographics").attr("y",-5).attr("class","legend-text"),h.append("text").text("more Whites").attr("y",d+10).attr("class","legend-text"),h.append("text").text("more Blacks").attr("x",p).attr("y",d+10).attr("text-anchor","end").attr("class","legend-text")}(Tr)}var Ir={init:function(){E("shape_with_stops.csv").then(t=>{(t=t.filter(t=>+t.resident_employee_ratio>=1)).forEach(t=>{t.neighborhood=""+t.Name.split(", ")[1],t.group1,t.group2}),Tr=t,Tr.sort((t,e)=>+e["%white"]-+t["%white"]),Or()})},resize:Or};const jr=[{image:"2018_02_stand-up",url:"2018/02/stand-up",hed:"The Structure of Stand-Up Comedy"},{image:"2018_04_birthday-paradox",url:"2018/04/birthday-paradox",hed:"The Birthday Paradox Experiment"},{image:"2018_11_boy-bands",url:"2018/11/boy-bands",hed:"Internet Boy Band Database"},{image:"2018_08_pockets",url:"2018/08/pockets",hed:"Womens Pockets are Inferior"}];let Nr=null;function zr(t){return`\n\t<a class='footer-recirc__article' href='https://pudding.cool/${t.url}' target='_blank' rel='noopener'>\n\t\t<img class='article__img' src='https://pudding.cool/common/assets/thumbnails/640/${t.image}.jpg' alt='${t.hed}'>\n\t\t<p class='article__headline'>${t.hed}</p>\n\t</a>\n\t`}var Cr={init:function(){!function(t){const e=new XMLHttpRequest,r="https://pudding.cool/assets/data/stories.json?v="+Date.now();e.open("GET",r,!0),e.onload=()=>{if(e.status>=200&&e.status<400){const r=JSON.parse(e.responseText);t(r)}else t(jr)},e.onerror=()=>t(jr),e.send()}(t=>{Nr=t,function(){const t=window.location.href;Nr.filter(e=>!t.includes(e.url)).slice(0,4).map(zr).join("")}()})}};const Hr=d3.select("body");let Rr=0;function Wr(){const t=Hr.node().offsetWidth;Rr!==t&&(Rr=t,et.resize(),_t.resize(),te.resize(),ae.resize(),ie.resize(),Ye.resize(),hr.resize(),Ir.resize())}s(),Hr.classed("is-mobile",i.any()),window.addEventListener("resize",o()(Wr,150)),function(){if(Hr.select("header").classed("is-sticky")){const t=Hr.select(".header__menu"),e=Hr.select(".header__toggle");e.on("click",()=>{const r=t.classed("is-visible");t.classed("is-visible",!r),e.classed("is-visible",!r)})}}(),k.init(),et.init(),_t.init(),te.init(),ae.init(),ie.init(),Ye.init(),hr.init(),Ir.init(),Cr.init()}]);